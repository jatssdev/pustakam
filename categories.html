<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/logo-small.png">
    <link rel="icon" type="image/png" href="./assets/img/logo-small.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title data-translate="categories-page-title">Pustakam - Categories</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
        name='viewport' />
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <link href="./assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="./assets/css/paper-dashboard.css?v=2.0.1" rel="stylesheet" />
    <link href="./assets/demo/demo.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body class="">
    <div class="wrapper ">
        <div class="sidebar" data-color="white" data-active-color="danger">
            <div class="logo">
                <a href="/" class="simple-text logo-mini">
                    <div class="logo-image-small">
                        <img src="./assets/img/logo-small.png">
                    </div>
                </a>
                <a href="/" class="simple-text logo-normal" data-translate="logotxt">
                    Pustakam
                </a>
            </div>
            <div class="sidebar-wrapper">
                <ul class="nav">
                    <li>
                        <a href="/">
                            <i class="nc-icon nc-bank"></i>
                            <p data-translate="dashboard">Dashboard</p>
                        </a>
                    </li>
                    <li>
                        <a href="./authers.html">
                            <i class="fa-solid fa-users"></i>
                            <p data-translate="authors">Authors</p>
                        </a>
                    </li>
                    <li class="active">
                        <a href="./categories.html">
                            <i class="fa fa-folder"></i>
                            <p data-translate="categories">Categories</p>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="main-panel">
            <nav class="navbar navbar-expand-lg navbar-absolute fixed-top navbar-transparent">
                <div class="container-fluid">
                    <div class="navbar-wrapper">
                        <a class="navbar-brand" href="javascript:;" data-translate="categories">Categories</a>
                    </div>
                    <div class="collapse navbar-collapse justify-content-end" id="navigation">
                        <select id="language-dropdown" class="form-control"
                            style="width: auto; display: inline-block; margin-right: 15px;">
                            <option value="en" data-translate="optionenglish">English</option>
                            <option value="hi" data-translate="optionhindi">Hindi</option>
                        </select>
                    </div>
                </div>
            </nav>
            <!-- End Navbar -->
            <div class="content" style="min-height: 75vh;">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-body">
                            <div id="table-container" style="display: none;" class="table-responsive">
                                <table class="table">
                                    <thead class="text-primary">
                                        <th data-translate="id">ID</th>
                                        <th data-translate="category_english">Category (English)</th>
                                        <th data-translate="category_hindi">Category (Hindi)</th>
                                        <th data-translate="actions">Actions</th>
                                    </thead>
                                    <tbody id="category-table-body">
                                        <!-- Rows will be dynamically inserted here -->
                                    </tbody>
                                </table>
                            </div>
                            <div id="loading" style="display: none; text-align: center; margin: 20px;">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="sr-only" data-translate="loading">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <footer class="footer footer-black footer-white">
                <div class="container-fluid">
                    <hr>
                    <div class="row">
                        <div class="credits mx-auto">
                            <span class="copyright">
                                ©
                                <script>document.write(new Date().getFullYear())</script> ,
                                <span data-translate="copyright">All copyright reserved by pustakam</span>
                            </span>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <script src="./assets/js/core/jquery.min.js"></script>
    <script src="./assets/js/core/popper.min.js"></script>
    <script src="./assets/js/core/bootstrap.min.js"></script>
    <script src="./assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
    <script src="./assets/js/paper-dashboard.min.js?v=2.0.1" type="text/javascript"></script>
    <script>
        let englishJson = {
            "logotxt": "Pustakam",
            "dashboard": "Dashboard",
            "authors": "Authors",
            "categories": "Categories",
            "id": "ID",
            "category_english": "Category (English)",
            "category_hindi": "Category (Hindi)",
            "actions": "Actions",
            "loading": "Loading...",
            "optionenglish": "English",
            "optionhindi": "Hindi",
            "categories-page-title": "Pustakam - Categories",
            "edit": "Edit",
            "delete": "Delete",
            "copyright": "All copyright reserved by pustakam"
        };

        let hindiJson = {
            "logotxt": "पुस्तकम",
            "dashboard": "डैशबोर्ड",
            "authors": "लेखक",
            "categories": "श्रेणियाँ",
            "id": "आईडी",
            "category_english": "श्रेणी (अंग्रेज़ी)",
            "category_hindi": "श्रेणी (हिंदी)",
            "actions": "कार्य",
            "loading": "लोड हो रहा है...",
            "optionenglish": "अंग्रेज़ी",
            "optionhindi": "हिंदी",
            "categories-page-title": "पुस्तकम - श्रेणियाँ",
            "edit": "संपादित करें",
            "delete": "हटाएं",
            "copyright": "सभी कॉपीराइट पुस्तकम द्वारा सुरक्षित"
        };

        function loadLanguage(language) {
            let translations = language === 'hi' ? hindiJson : englishJson;
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                element.textContent = translations[key] || key;
            });
        }

        document.getElementById('language-dropdown').addEventListener('change', function () {
            const selectedLanguage = this.value;
            localStorage.setItem('language', selectedLanguage);
            loadLanguage(selectedLanguage);
        });

        document.addEventListener('DOMContentLoaded', () => {
            const language = localStorage.getItem('language') || 'en';
            document.getElementById('language-dropdown').value = language;
            loadLanguage(language);
        });

        const getCategories = async () => {
            try {
                document.getElementById('loading').style.display = 'block';
                document.getElementById('table-container').style.display = 'none';

                let response = await fetch('https://pustakam.pythonanywhere.com/category/');
                let result = await response.json();

                if (result.status === "success") {
                    let categories = result.data;
                    let tableBody = document.getElementById('category-table-body');
                    tableBody.innerHTML = '';

                    categories.forEach(category => {
                        let row = `
                            <tr>
                                <td>${category.id}</td>
                                <td>${category.category_english}</td>
                                <td>${category.category_hindi}</td>
                                <td>
                                    <button class="btn btn-warning btn-sm" data-translate="edit" onclick="editCategory(${category.id})">Edit</button>
                                    <button class="btn btn-danger btn-sm" data-translate="delete" onclick="deleteCategory(${category.id})">Delete</button>
                                </td>
                            </tr>
                        `;
                        tableBody.insertAdjacentHTML('beforeend', row);
                    });

                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('table-container').style.display = 'block';
                } else {
                    console.error('Failed to load data:', result);
                }
            } catch (error) {
                console.error('Error fetching categories:', error);
            } finally {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('table-container').style.display = 'block';
            }
        }

        getCategories();

        function editCategory(id) {
            console.log(`Edit category with ID ${id}`);
        }

        function deleteCategory(id) {
            console.log(`Delete category with ID ${id}`);
        }
    </script>
</body>

</html>